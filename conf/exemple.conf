# Configuration des serveurs virtuels
server {
    listen 8080; # Écoute sur le port HTTP
    listen 8081; # Écoute sur le port HTTP
    server_name example.com www.example.com; # Domaine(s) géré(s)
    server{}
    # Redirection HTTP → HTTPS (commenté si pas de HTTPS)
    # return 301 https://$server_name$request_uri;

    # Racine du site
    root /var/www/html;
}
    index index.html index.htm index.php;

    # Configuration des logs pour ce serveur
    access_log /var/log/nginx/example.com.access.log;
    error_log /var/log/nginx/example.com.error.log;
    # Bloc pour gérer les erreurs
    error_page 404 /404.html;
    error_page 500 502 503 504 /50x.html;

    # Bloc pour les fichiers statiques (cache optimisé)
    location ~* \.(jpg|jpeg|png|gif|ico|css|js|woff2)$ {
        expires 365d; # Cache pendant 1 an
        add_header Cache-Control "public, no-transform";
    }

    # Bloc pour PHP-FPM (si utilisé)
    location ~ \.php$ {
        include snippets/fastcgi-php.conf;
        fastcgi_pass unix:/run/php/php8.1-fpm.sock; # Ajustez la version PHP
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include fastcgi_params;
    }

    # Désactive l'accès aux fichiers cachés (.htaccess, .env, etc.)
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }

    # Protection contre les attaques (ex: injections)
    location ~* (\.env|\.git|\.svn|\.ht) {
        deny all;
        return 403;
    }
    server{
        listen 80;

    }
}